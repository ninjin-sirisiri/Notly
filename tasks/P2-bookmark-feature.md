---
priority: P2 (中優先度)
status: 未着手
estimated_time: 1-2日
---

# お気に入り/ブックマーク機能

## 概要
頻繁にアクセスするノートをお気に入りに登録し、サイドバーから素早くアクセスできるようにします。

## 背景・目的
- **現状の課題**: 
  - よく使うノートを探すのに時間がかかる
  - フォルダ階層が深いと辿るのが面倒
- **期待される効果**:
  - よく使うノートへの素早いアクセス
  - ワークフローの効率化
  - ユーザー体験の向上

## 実装要件

### 機能要件
1. **お気に入り登録・解除**
   - ノートをお気に入りに追加
   - お気に入りから削除
   - スター/ハートアイコンでのトグル

2. **お気に入り一覧**
   - サイドバーに「お気に入り」セクションを追加
   - お気に入りノートを一覧表示
   - 並び替え機能（手動ドラッグ、名前順、更新日順など）

3. **お気に入り表示**
   - ノートアイテムにお気に入りマークを表示
   - お気に入り状態が一目でわかる

### データベース設計

#### notesテーブルの拡張
- `is_favorite` (BOOLEAN, DEFAULT FALSE) 列を追加
- `favorite_order` (INTEGER, NULLABLE) - 並び順

### 技術要件

#### バックエンド
1. **新規/拡張コマンド**
   - `toggle_favorite(note_id)` - お気に入りのトグル
   - `get_favorite_notes()` - お気に入りノート一覧取得
   - `update_favorite_order(note_id, order)` - 並び順更新

2. **既存コマンドの拡張**
   - `get_all_notes()`: `is_favorite` フラグも含める

#### フロントエンド
1. **ストア拡張**
   - `src/stores/notes.ts` にお気に入り関連の状態を追加

2. **UI追加/変更**
   - `src/components/layout/sidebar/FavoriteSection.tsx` - お気に入りセクション
   - `src/components/layout/sidebar/NoteItem.tsx` - お気に入りアイコン追加
   - アイコン: Lucide React の `Star` / `StarOff`

## 実装手順

### Phase 1: データベースとバックエンド
1. マイグレーション作成（is_favorite, favorite_order カラム追加）
2. お気に入り関連のコマンド実装

### Phase 2: フロントエンド基本機能
1. ノートアイテムにお気に入りアイコン追加
2. トグル機能の実装

### Phase 3: お気に入り一覧
1. サイドバーにお気に入りセクション追加
2. お気に入りノート一覧表示

### Phase 4: 並び替え機能（オプション）
1. ドラッグ&ドロップでの並び替え
2. 並び順の永続化

## UI/UXデザイン案

### お気に入りアイコン
- ノートアイテムの右端に配置
- ホバー時に表示、またはお気に入り時は常時表示
- クリックでトグル

### お気に入りセクション
- サイドバー上部に配置（検索の下）
- 最大10件表示、オーバーフロー時はスクロール
- または折りたたみ可能

## 参考資料
- Chrome ブックマーク
- VSCode のお気に入りファイル機能
- Notion のお気に入りページ

## 関連タスク
- P1-drag-and-drop.md - お気に入りセクション内での並び替え

## 備考
- シンプルで実装しやすい機能
- ユーザビリティへの影響が大きい
- Phase 4 の並び替えは後回しでも可
