---
priority: P2 (中優先度)
status: 未着手
estimated_time: 2-3日
---

# エクスポート/インポート機能

## 概要
ノートやフォルダ構造を外部ファイルとしてエクスポートし、他の環境でインポートできるようにします。データの移行やバックアップに役立ちます。

## 背景・目的
- **現状の課題**: 
  - データの移行手段がない
  - バックアップが手動でしかできない
  - 他のノートアプリとの連携ができない
- **期待される効果**:
  - データポータビリティの向上
  - バックアップの簡便化
  - 他ツールとの互換性

## 実装要件

### 機能要件

#### エクスポート
1. **個別ノートのエクスポート**
   - Markdown形式（.md）
   - HTML形式
   - PDF形式（将来的）

2. **フォルダ単位のエクスポート**
   - フォルダ構造を保持したままZIP化
   - 全ノートを一括エクスポート

3. **メタデータの保持**
   - 作成日時、更新日時
   - タグ情報（タグ機能実装後）
   - フォルダ構造

4. **エクスポート形式**
   - Markdown（デフォルト）
   - JSON（メタデータ付き）
   - ZIP（複数ファイル）

#### インポート
1. **Markdownファイルのインポート**
   - 単一ファイル
   - 複数ファイル（フォルダごと）

2. **他ツールからのインポート**
   - Bear、Obsidian、Notion等からのMarkdownインポート
   - フロントマター（YAMLメタデータ）の解析

3. **フォルダ構造の復元**
   - インポート時にフォルダ構造を再現
   - 既存のフォルダ構造とのマージ

### 技術要件

#### バックエンド
1. **新規コマンド**
   - `export_note(note_id, format)` - ノートをエクスポート
   - `export_folder(folder_id, format)` - フォルダをエクスポート
   - `export_all(format)` - すべてエクスポート
   - `import_markdown_file(path)` - Markdownファイルをインポート
   - `import_folder(path)` - フォルダ構造ごとインポート

2. **Rustライブラリ**
   - `pulldown-cmark` - Markdownパース
   - `zip` - ZIP圧縮
   - `serde_json` - JSONシリアライズ
   - （将来的）`headless_chrome` / `wkhtmltopdf` - PDF生成

#### フロントエンド
1. **UI追加**
   - `src/components/export/ExportDialog.tsx` - エクスポートダイアログ
   - `src/components/import/ImportDialog.tsx` - インポートダイアログ
   - メニューバーに「エクスポート」「インポート」項目追加

2. **ファイル選択**
   - Tauriの `dialog` APIを使用してファイル保存/選択ダイアログ

## 実装手順

### Phase 1: 基本エクスポート（Markdown）
1. 個別ノートのMarkdownエクスポート実装
2. エクスポートダイアログUI作成
3. ファイル保存ダイアログの統合

### Phase 2: フォルダ/一括エクスポート
1. フォルダ構造を保持したZIPエクスポート
2. メタデータをJSONで保存

### Phase 3: インポート機能
1. 単一Markdownファイルのインポート
2. フォルダ構造のインポート
3. フロントマター解析

### Phase 4: 高度な形式（HTML, PDF）
1. HTML形式のエクスポート
2. PDF生成（オプション）

## データ形式例

### JSON形式（メタデータ付き）
```json
{
  "notes": [
    {
      "id": "note-123",
      "title": "サンプルノート",
      "content": "# サンプルノート\n\nこれはサンプルです。",
      "path": "/フォルダ1/サンプルノート.md",
      "created_at": "2025-01-01T00:00:00Z",
      "updated_at": "2025-01-02T12:00:00Z",
      "tags": ["タグ1", "タグ2"]
    }
  ],
  "folders": [
    {
      "id": "folder-1",
      "name": "フォルダ1",
      "parent_id": null
    }
  ]
}
```

### Markdown + Frontmatter
```markdown
---
title: サンプルノート
created: 2025-01-01T00:00:00Z
updated: 2025-01-02T12:00:00Z
tags: [タグ1, タグ2]
---

# サンプルノート

これはサンプルです。
```

## 設計上の注意点
- インポート時の重複チェック（同名ノートの扱い）
- 大量データのエクスポート時のパフォーマンス
- セキュリティ（任意のファイルを開けないように）

## 参考資料
- Obsidian のエクスポート/インポート
- Notion のエクスポート機能
- Bear のエクスポート機能

## 関連タスク
- README.md Phase 4 - バックアップ機能
- P2-tag-system.md - タグのエクスポート/インポート

## 備考
- バックアップ機能の基盤となる重要な機能
- PDF生成は処理が重いため Phase 4 またはそれ以降で実装
