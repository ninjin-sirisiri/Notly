# ノート・フォルダ関連機能の実装タスク

このドキュメントは、ノートおよびフォルダ機能において未実装または改善が必要な機能をまとめたものです。

## 優先度: 高 (High)

### 1. フォルダの全展開・全折りたたみ (Collapse/Expand All Folders)
- **現状**: 個別のフォルダごとにしか開閉できない。
- **タスク**:
  - [x] サイドバーヘッダーに「すべて展開」「すべて折りたたむ」ボタンを追加する。
  - [x] `FolderStore` に `expandAllFolders` と `collapseAllFolders` アクションを追加する。
  - [x] 再帰的にフォルダIDを取得して `openFolderIds` を更新するロジックを実装する。

## 優先度: 中 (Medium)

### 2. ノートのエクスポート (Note Export)
- **現状**: ノートを外部ファイルとして保存する機能がない（データは内部DB/ファイルシステムにあるが、ユーザーが明示的にエクスポートできない）。
- **タスク**:
  - [x] ノートのコンテキストメニューに「エクスポート」を追加する。
  - [x] Markdown (.md), PDF (.pdf), HTML (.html) 形式での保存をサポートする。
  - [x] Tauriの `save` ダイアログを使用して保存先を選択させる。

### 3. 一括お気に入り・タグ付け (Batch Favorite/Tag)
- **現状**: 一括操作は「移動」と「削除」のみサポートされている。
- **タスク**:
  - [x] `BulkActions` コンポーネントに「お気に入りに追加/解除」ボタンを追加する。
  - [x] `BulkActions` コンポーネントに「タグを追加」ボタンを追加する。
  - [x] 選択されたノートIDに対して一括処理を行うバックエンドAPI (`add_tag_to_notes`, `toggle_favorite_notes` 等) を実装する。

### 4. ノート情報表示 (Note Info)
- **現状**: ノートの作成日や文字数を確認する専用の画面がない。
- **タスク**:
  - [x] エディタのヘッダーまたはサイドバーのコンテキストメニューに「情報」または「詳細」オプションを追加する。
  - [x] モーダルまたはポップオーバーで以下の情報を表示する:
    - 作成日時
    - 更新日時
    - 文字数 / 単語数
    - 保存場所 (パス)
    - 関連タグ

## 優先度: 低 (Low)

### 5. ノートのインポート (Note Import)
- **現状**: 外部のMarkdownファイルをインポートする機能がない。
- **タスク**:
  - [x] サイドバーヘッダーまたは設定に「インポート」機能を追加する。
  - [x] 複数ファイルの選択をサポートする。
  - [x] インポート時にタグ付けやフォルダ振り分けができると尚良い。

### 6. フォルダのカスタマイズ (Folder Customization)
- **現状**: すべてのフォルダが同じアイコン・色で表示される。
- **タスク**:
  - [x] データベースの `folders` テーブルに `icon` や `color` カラムを追加する。
  - [x] フォルダのコンテキストメニューに「アイコン変更」「色変更」を追加する。
  - [x] サイドバーの `FolderItem` コンポーネントでカスタムスタイルを反映させる。

### 7. 詳細検索 (Advanced Search)
- **現状**: タイトルと本文のテキスト検索のみ。
- **タスク**:
  - [x] 検索バーにフィルター機能を追加する。
  - [x] タグ、作成日範囲、更新日範囲、お気に入り有無などで絞り込み可能にする。
  - [x] 検索クエリ構文 (例: `tag:todo`, `is:favorite`) をサポートする。

### 8. フォルダごとの並び替え設定 (Per-folder Sort Settings)
- **現状**: 並び替え設定はアプリ全体で共有されている。
- **タスク**:
  - [x] `folders` テーブルに `sort_by` と `sort_order` カラムを追加する。
  - [x] フォルダを開いた際に、そのフォルダ固有の並び替え設定を適用する。
  - [x] 設定がない場合はグローバル設定を使用する。